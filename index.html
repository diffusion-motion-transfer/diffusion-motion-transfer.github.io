
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
    <!-- Replace the content tag with appropriate information -->
<!--    <meta name="description" content="DESCRIPTION META TAG">-->
<!--    <meta property="og:title" content="SOCIAL MEDIA TITLE TAG"/>-->
<!--    <meta property="og:description" content="SOCIAL MEDIA DESCRIPTION TAG TAG"/>-->
<!--    <meta property="og:url" content="URL OF THE WEBSITE"/>-->
    <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
<!--    <meta property="og:image" content="static/image/your_banner_image.png"/>-->
<!--    <meta property="og:image:width" content="1200"/>-->
<!--    <meta property="og:image:height" content="630"/>-->


<!--    <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">-->
<!--    <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">-->
    <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
<!--    <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">-->
<!--    <meta name="twitter:card" content="summary_large_image">-->
    <!-- Keywords for your paper to be indexed by-->
<!--    <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1">-->


    <title>Space-Time Diffusion Features for Zero-Shot Text-Driven Motion Transfer</title>
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.css">
    <link rel="stylesheet" href="static/css/index.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>


    <!-- bootstrap 4.5 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"></script>

    <!-- slick 1.9 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.js"></script>

    <!--    mathjax -->
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="static/js/index.js"></script>
    <link href="https://fonts.cdnfonts.com/css/chalkduster" rel="stylesheet">
    <style>
        @import url('https://fonts.cdnfonts.com/css/chalkduster');
    </style>


</head>
<body>


<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title">Space-Time Diffusion Features for Zero-Shot <br> Text-Driven
                        Motion Transfer</h1>
                    <div class="is-size-5 publication-authors">
                        <!-- Paper authors -->
                        <span class="author-block">
                        <a href="https://www.linkedin.com/in/danah-yatim-4b15231b5/" target="_blank">Danah Yatim</a><sup>*</sup>,</span>
                        <span class="author-block">
                        <a href="https://www.linkedin.com/in/rafail-fridman/" target="_blank">Rafail Fridman</a><sup>*</sup>,</span>
                          <span class="author-block">
                          <a href="https://omerbt.github.io" target="_blank">Omer Bar-Tal</a>,</span>
                          <span class="author-block">
                            <a href="https://ykasten.github.io/" target="_blank">Yoni Kasten</a>,
                          </span>
                          <span class="author-block">
                            <a href="https://www.weizmann.ac.il/math/dekel/" target="_blank">Tali Dekel</a>
                          </span>
                          </div>

                          <div class="is-size-5 publication-authors">
                            <span class="author-block">Weizmann Institute of Science</span>
                            <span class="eql-cntrb"><small><br><sup>*</sup>Indicates Equal Contribution</small></span>
                          </div>

                          <div class="column has-text-centered">
                            <div class="publication-links">
                                 <!-- Arxiv PDF link -->
                              <span class="link-block">
                                <a href='./MotionEditing_arXiv.pdf' target="_blank"
                                class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                  <i class="fas fa-file-pdf"></i>
                                </span>
                                <span>Paper</span>
                                  </a>
                                </span>

                                <span class="link-block">
                                <a href="https://arxiv.org/abs/2311.17009" class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                  <i class="ai ai-arxiv"></i>
                                </span>
                                <span>Arxiv</span>
                                  </a>
                                </span>

                                <span class="link-block">
                                <a class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                  <i class="fa-brands fa-github"></i>
                                </span>
                                <span>Code (coming soon)</span>
                                  </a>
                                </span>

                                <!-- Supplementary PDF link -->
                                <span class="link-block">
                                  <a href="sm/index.html" target="_blank"
                                     class="external-link button is-normal is-rounded is-dark">
                                  <span>Supplementary Material</span>
                                </a>
                              </span>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
    </div>
</section>


<!-- Teaser video-->

<!--<div w3-include-html="carousel.html"></div>-->



<div class="container" id="carousel">
    <div id="slick">

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/dog_lion_dragon.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A lion sitting in a forest</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A dragon sitting in a floral forest</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/car-turn_bike_train.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A bike driving in a snowy forest</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A train riding on rails in autumn view</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/dog_jump_horse_dolphin.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A horse jumping into a river</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A dolphin jumping into the ocean</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/elephant_camel_giraffe.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A camel crossing a road in a savannah</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A giraffe crossing a road in a savannah</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/cute_kittens_monkeys_rabbits.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">Monkeys playing with coconuts</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">Rabbits playing with easter eggs</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/locomotive_airplane_motorbike.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">An airplane driving in a forest</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A motorbike driving in a forest</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/rubber_duck_duck_penguin.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A duck swimming in a pond</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A penguin swimming in outer space</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/chick_flamingo_goose.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A flamingo walking in a field</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A goose walking in a field</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/frisbee_dog_bear_cat.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A bear catching a frisbee in the field</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A cat catching a frisbee in the field</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/libby_cat_horse.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A cat running in the cosmos</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A horse running near a fence</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/bear_camel_elephant.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A camel walking on icy rocks in antarctica</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">An elephant walking on the rocks</td>
              </tr>
            </table>
        </div>
    </div>
</div>

<div class="slide">
    <div class="card">
        <video class="img-fluid" autoplay loop muted playsinline>
            <source src="sm/assets/results_concatenated/airplane_car_bus.mp4" type="video/mp4">
        </video>
        <div class="card-body">
            <table style="width:100%">
              <tr>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A car driving on a road</td>
                <td style="text-align: center; font-family: Chalkduster,serif;width: 50%">A bus driving on a road</td>
              </tr>
            </table>
        </div>
    </div>
</div>

    </div>
</div>



<!-- Paper abstract -->
<section class="section hero is-light">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">Abstract</h2>
                <div class="content has-text-justified">
                    <p>
                        We present a new method for text-driven motion transfer - synthesizing a video that complies with an input
                        text prompt describing the target objects and scene while maintaining an input video's motion and scene layout.
                        Prior methods are confined to transferring motion across two subjects within the same or closely related object
                        categories and are applicable for limited domains (e.g., humans). In this work, we consider a significantly more
                        challenging setting in which the target and source objects differ drastically in shape and fine-grained motion
                        characteristics (e.g., translating a jumping dog into a dolphin).  To this end, we leverage a pre-trained and fixed
                        text-to-video diffusion model, which provides us with generative and motion priors. The pillar of our method is
                        a new space-time feature loss derived directly from the model. This loss guides the generation process to preserve
                        the overall motion of the input video while complying with the target object in terms of shape and fine-grained motion traits.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End paper abstract -->

<!-- Paper poster -->
<section class="hero is-small">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-">
                    <h2 class="title is-3">Space-Time Analysis of Diffusion Features</h2>
                    <div class="content has-text-justified">
                        <p>
                        We focus our analysis on features extracted from the intermediate layers
                        activations of the video model. To gain a better understanding of what the features
                        $\{\boldsymbol{f}(\boldsymbol{x}_t)\}_{t=1}^T$  extracted for each diffusion timestep $t$ encode,
                        we adopt the concept of “feature inversion”. We observe that videos produced by feature inversion nearly
                        reconstruct the original frames, regardless of the random inilialization (i.e different seeds).
                        This suggests that the features encode the original objects' pose, shape, and appearance.
                        <br>
                        To reduce dependency on pixel-level information and enhance robustness to
                        variations in appearance and shape, we introduce a new feature descriptor termed
                        <strong>Spatial Marginal Mean (SMM)</strong>:
                        </p>
                         $$\texttt{SMM}[\boldsymbol{f}(\boldsymbol{x}_t)] = \frac{1}{M\cdot N} \sum_{i=1}^M \sum_{j=1}^N \boldsymbol{f}(\boldsymbol{x}_t)_{i,j}$$
                        <p>
                        This descriptor is obtained by averaging the space-time features along the spatial dimensions.
                        Despite collapsing the spatial dimensions, the SMM features retain information about objects' pose and semantic layout,
                        showcasing robustness to appearance and shape variations.
                        <br> The following videos demonstrate sample results for feature inversion using the original features and the SMM features.  Each row represents a different random starting point.
                        </p>
                        <table id="analysisTable">
                            <tbody>
                            <tr>
                                <th style="font-size: 16px"></th>
                                <th style="font-size: 16px; text-align: center;">Original</th>
                                <th style="font-size: 16px; text-align: center;">Space-time feature loss</th>
                                <th style="font-size: 16px; text-align: center;">SMM feature loss</th>
                            </tr>
                            <tr class="video-row">
                                 <th style="font-size: 16px; vertical-align: middle">Seed 1</th>
                                <td style="text-align: center;">
                                    <a href="sm/assets/analysis/original.mp4">
                                        <video preload="auto" width="320" height="320"
                                               src="sm/assets/analysis/original.mp4" autoplay loop muted playsinline/>
                                    </a>
                                </td>
                                <td style="text-align: center;">
                                    <a href="sm/assets/analysis/seed_14/full.mp4">
                                        <video preload="auto" width="320" height="320"
                                               src="sm/assets/analysis/seed_14/full.mp4" autoplay loop muted playsinline/>
                                    </a>
                                </td>
                                <td style="text-align: center;">
                                    <a href="sm/assets/analysis/seed_14/avg.mp4">
                                        <video preload="auto" width="320" height="320"
                                               src="sm/assets/analysis/seed_14/avg.mp4" autoplay loop muted playsinline/>
                                    </a>
                                </td>
                            </tr>
                            <tr class="video-row">
                                 <th style="font-size: 16px; vertical-align: middle">Seed 2</th>
                                <td style="text-align: center;">
                                    <a href="sm/assets/analysis/original.mp4">
                                        <video preload="auto" width="320" height="320"
                                               src="sm/assets/analysis/original.mp4" autoplay loop muted playsinline/>
                                    </a>
                                </td>
                                <td style="text-align: center;">
                                    <a href="assets/analysis/seed_14/full.mp4">
                                        <video preload="auto" width="320" height="320"
                                               src="sm/assets/analysis/seed_15/full.mp4" autoplay loop muted playsinline/>
                                    </a>
                                </td>
                                <td style="text-align: center;">
                                    <a href="sm/assets/analysis/seed_15/avg.mp4">
                                        <video preload="auto" width="320" height="320"
                                               src="sm/assets/analysis/seed_15/avg.mp4" autoplay loop muted playsinline/>
                                    </a>
                                </td>
                            </tr>
                            </tbody>
                        </table>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!--End paper poster -->

<section class="hero is-small is-light">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-">
                    <h2 class="title is-3">Method</h2>
                    <div class="content has-text-justified">
                         Given an input video, we apply DDIM inversion and extract space-time features $\boldsymbol{f}\in \mathbb{R}^{F\times M \times N \times D}$
                        from intermediate layer activations. We obtain our Spatial Marginal Mean (SMM) feature $\texttt{SMM}[\boldsymbol{f}] \in \mathbb{R}^{F \times D}$ by computing
                        the mean over the spatial dimensions. We observed that directly optimizing for SMM features often prevents us from deviating from the original appearance.
                        To circumvent this problem, we propose an objective function that aims to preserve the pairwise differences of the SMM features, rather than their exact values,
                        and utilize for guidance during sampling. See Sec. 4 of the paper for more details.
                        <br>
                        <br>

                        <img src="sm/assets/pics/pipeline.png" alt="pipeline" width="100%">

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="hero is-small">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-">
                    <h2 class="title is-3">Measuring Motion Fidelity</h2>
                    <div class="content has-text-justified">
                      We aim to assess the fidelity of our results in preserving the original motion. Given our task
                        involves structural deviations, there is no alignment between pixels in the original and output videos.
                        Consequentially, traditional metrics such as comparing optical-flow fields are unsuitable for our use case.
                        We thus introduce a new metric, based on similarity between unaligned long-trajectories. For two sets of
                        trajectories $\mathcal{T}$ and $\tilde{\mathcal{T}}$ extracted from the original and output videos, respectively, the metric is defined as:
                        $$\frac{1}{m}\sum_{\tilde{\tau}\in \tilde{\mathcal{T}}} \underset{\tau \in \mathcal{T} }{\text{max}} \ \textbf{corr} (\tau,\tilde{\tau})+\frac{1}{n}\sum_{{\tau}\in {\mathcal{T}}} \underset{\tilde{\tau} \in \tilde{\mathcal{T}} }{\text{max}} \ \textbf{corr} (\tau,\tilde{\tau})$$
                        where the correlation between two tracklets $\textbf{corr}(\tau,\tilde{\tau})$ is computed as follows, similarly to <a href="#ref-motion">[1]</a>:
                        $$\textbf{corr}(\tau,\tilde{\tau}) =  \dfrac{1}{F}\sum_{k=1}^F\dfrac{{v_k^x \cdot \tilde{v}_k^x + v_k^y \cdot \tilde{v}_k^y}}{{\sqrt{(v_k^x)^2 + (v_k^y)^2} \cdot \sqrt{(\tilde{v}_k^x)^2 + (\tilde{v}_k^y)^2}}}$$

                        Our method outperforms the baselines by achieving both high fidelity to the target text prompt (CLIP text similarity score) and the original motion (Motion-Fidelity score).
                        <br>
                        <br>

                        <div style="text-align: center;">
                            <img src="sm/assets/pics/metrics.png" alt="motion_fidelity" id="metrics_image">
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Teaser video-->
<section class="section hero is-light">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
              <video preload="auto" autoplay controls muted loop playsinline width="600px">
                <source src="sm/assets/teaser.mp4"
                type="video/mp4">
              </video>
            </div>
        </div>
    </div>
</section>
<!-- End teaser video -->

<!-- End video preload="auto"carousel -->

<!--BibTex citation -->
<section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@article{yatim2023spacetime,
        title = {Space-Time Diffusion Features for Zero-Shot Text-Driven Motion Transfer},
        author = {Yatim, Danah and Fridman, Rafail and Bar-Tal, Omer and Kasten, Yoni and Dekel, Tali},
        journal={arXiv preprint arxiv:2311.17009},
        year={2023}
        }</code></pre>
    </div>
</section>
<!--End BibTex citation -->

<section class="hero is-small">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-">
                    <div class="content has-text-justified">
                     <a id="ref-motion"></a>
                            [1] Ce Liu, Antonio Torralba, William T Freeman, Fredo Durand, and Edward H Adelson. Motion magnification. ACM transactions on graphics (TOG), 24(3):519–526, 2005

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a>.
            You are free to borrow the of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>
</body>

</html>
